model Task {
  // Metadata
  id          String         @id @default(dbgenerated("generate_prefixed_cuid('tsk'::text)"))
  title       String
  description String
  status           TaskStatus           @default(todo)
  automationStatus TaskAutomationStatus @default(AUTOMATED)
  frequency        TaskFrequency?
  department  Departments?   @default(none)
  order       Int            @default(0)

  // Dates
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  lastCompletedAt DateTime?
  reviewDate      DateTime?

  // Relationships
  assigneeId          String?
  assignee            Member?                      @relation(fields: [assigneeId], references: [id])
  organizationId      String
  organization        Organization                 @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  taskTemplateId      String?
  taskTemplate        FrameworkEditorTaskTemplate? @relation(fields: [taskTemplateId], references: [id])
  controls            Control[]
  vendors             Vendor[]
  risks               Risk[]
  evidenceAutomations EvidenceAutomation[]
  browserAutomations  BrowserAutomation[]

  EvidenceAutomationRun EvidenceAutomationRun[]
  integrationCheckRuns  IntegrationCheckRun[]
  findings              Finding[]

  // Evidence approval
  approverId     String?
  approver       Member?     @relation("TaskApprover", fields: [approverId], references: [id])
  approvedAt     DateTime?
  previousStatus TaskStatus?
}

enum TaskStatus {
  todo
  in_progress
  in_review
  done
  not_relevant
  failed
}

enum TaskFrequency {
  daily
  weekly
  monthly
  quarterly
  yearly
}

enum TaskAutomationStatus {
  AUTOMATED
  MANUAL
}
