enum PolicyDisplayFormat {
  EDITOR
  PDF
}

model Policy {
  id               String              @id @default(dbgenerated("generate_prefixed_cuid('pol'::text)"))
  name             String
  description      String?
  status           PolicyStatus        @default(draft)
  content          Json[]
  frequency        Frequency?
  department       Departments?
  isRequiredToSign Boolean             @default(true)
  signedBy         String[]            @default([])
  reviewDate       DateTime?
  isArchived       Boolean             @default(false)
  displayFormat    PolicyDisplayFormat @default(EDITOR)
  pdfUrl           String?

  // Dates
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  lastArchivedAt  DateTime?
  lastPublishedAt DateTime?

  // Relationships
  organizationId   String
  organization     Organization                   @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  assigneeId       String?
  assignee         Member?                        @relation("PolicyAssignee", fields: [assigneeId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  approverId       String?
  approver         Member?                        @relation("PolicyApprover", fields: [approverId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  policyTemplateId String?
  policyTemplate   FrameworkEditorPolicyTemplate? @relation(fields: [policyTemplateId], references: [id])
  controls         Control[]

  @@index([organizationId])
}
